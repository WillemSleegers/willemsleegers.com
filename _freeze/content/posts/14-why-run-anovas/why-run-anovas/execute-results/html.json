{
  "hash": "ea55ce153ed69a53a56912d5f0874b7e",
  "result": {
    "markdown": "---\ntitle: Why run ANOVAs?\ndescription: \"I often see researchers analyze group differences by first running an ANOVA and then looking at contrasts. Given that the interest is in the group differences, I don't understand why we don't run those contrasts right from the start.\"\ndate: 2022-06-02\ncategories:\n  - statistics\ncode-fold: true\ncode-tools: true\ntoc: true\ndraft: true\n---\n\n\nIn the field of social psychology I often see researchers analyze group differences by first running an ANOVA and then following up the ANOVA with contrast analyses to inspect specific group differences.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load packages\nlibrary(MASS)\nlibrary(tidyverse)\nlibrary(viridis)\n\n# Set the default ggplot theme\ntheme_set(theme_minimal())\n\n# Set options\noptions(\n  knitr.kable.NA = \"\",\n  digits = 2\n)\n```\n:::\n\n\n## The data\n\nSay we ran a study with five different conditions. I'll simulate some data below so we have something concrete to think about.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Set the simulation parameters\nMs <- c(0, 0, 0, 0.2, 0.2)\nSDs <- 1\nn <- 195\n\n# Produce the variance-covariance matrix\nSigma <- matrix(nrow = 5, ncol = 5, data = c(\n    SDs, 0, 0, 0, 0,\n    0, SDs, 0, 0, 0,\n    0, 0, SDs, 0, 0,\n    0, 0, 0, SDs, 0,\n    0, 0, 0, 0, SDs\n  )\n)\n\n# Simulate the values\nm <- mvrnorm(n = n, mu = Ms, Sigma = Sigma, empirical = TRUE)\n\n# Prepare the data by converting it to a data frame and making it tidy\ncolnames(m) <- c(\"group1\", \"group2\", \"group3\", \"group4\", \"group5\")\n\ndata <- as_tibble(m)\n\ndata <- pivot_longer(\n  data = data, \n  cols = everything(), \n  names_to = \"condition\", \n  values_to = \"DV\"\n)\n\n# Plot the simulated data\nggplot(data, aes(x = condition, y = DV)) +\n  geom_jitter(width = .2, alpha = .25) +\n  stat_summary(fun.data = \"mean_cl_boot\", geom = \"pointrange\") +\n  labs(x = \"Condition\")\n```\n\n::: {.cell-output-display}\n![](why-run-anovas_files/figure-html/setting-1.png){width=672}\n:::\n:::\n\n\n## The goals\n\nWith this kind of data I can imagine at least two different goals that a researcher may have. You could have a clear a priori prediction of which groups differ or you can go on a fishing expedition and simply see which conditions differ from each other.\n\nIt looks like that worked out, so now let's analyze the data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova <- aov(DV ~ condition, data = data)\nsummary(anova)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             Df Sum Sq Mean Sq F value Pr(>F)  \ncondition     4      9    2.34    2.34  0.053 .\nResiduals   970    970    1.00                 \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nlm <- lm(DV ~ condition, data = data)\nsummary(lm)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = DV ~ condition, data = data)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-3.427 -0.697  0.020  0.633  4.021 \n\nCoefficients:\n                 Estimate Std. Error t value Pr(>|t|)  \n(Intercept)     -1.48e-15   7.16e-02    0.00    1.000  \nconditiongroup2  8.45e-16   1.01e-01    0.00    1.000  \nconditiongroup3  1.50e-15   1.01e-01    0.00    1.000  \nconditiongroup4  2.00e-01   1.01e-01    1.97    0.049 *\nconditiongroup5  2.00e-01   1.01e-01    1.97    0.049 *\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1 on 970 degrees of freedom\nMultiple R-squared:  0.00956,\tAdjusted R-squared:  0.00547 \nF-statistic: 2.34 on 4 and 970 DF,  p-value: 0.0535\n```\n:::\n\n```{.r .cell-code}\npairwise.t.test(data$DV, data$condition)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPairwise comparisons using t tests with pooled SD \n\ndata:  data$DV and data$condition \n\n       group1 group2 group3 group4\ngroup2 1.0    -      -      -     \ngroup3 1.0    1.0    -      -     \ngroup4 0.5    0.5    0.5    -     \ngroup5 0.5    0.5    0.5    1.0   \n\nP value adjustment method: holm \n```\n:::\n\n```{.r .cell-code}\nlibrary(emmeans)\nemmeans <- emmeans(lm, specs = pairwise ~ condition)\nemmeans\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$emmeans\n condition emmean    SE  df lower.CL upper.CL\n group1       0.0 0.072 970   -0.141     0.14\n group2       0.0 0.072 970   -0.141     0.14\n group3       0.0 0.072 970   -0.141     0.14\n group4       0.2 0.072 970    0.059     0.34\n group5       0.2 0.072 970    0.059     0.34\n\nConfidence level used: 0.95 \n\n$contrasts\n contrast        estimate    SE  df t.ratio p.value\n group1 - group2      0.0 0.101 970   0.000  1.0000\n group1 - group3      0.0 0.101 970   0.000  1.0000\n group1 - group4     -0.2 0.101 970  -1.970  0.2800\n group1 - group5     -0.2 0.101 970  -1.970  0.2800\n group2 - group3      0.0 0.101 970   0.000  1.0000\n group2 - group4     -0.2 0.101 970  -1.970  0.2800\n group2 - group5     -0.2 0.101 970  -1.970  0.2800\n group3 - group4     -0.2 0.101 970  -1.970  0.2800\n group3 - group5     -0.2 0.101 970  -1.970  0.2800\n group4 - group5      0.0 0.101 970   0.000  1.0000\n\nP value adjustment: tukey method for comparing a family of 5 estimates \n```\n:::\n:::\n",
    "supporting": [
      "why-run-anovas_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}